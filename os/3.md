# 信号量

信号量（Semaphore）是一个同步对象，是非负整型变量，除了初始化外，只能通过两个标准原子操作wait()和signal()来访问。这两个操作也被称为PV原语（P—减少，V增加）。

当进程/线程完成一次对该信号量对象的等待时，计数器减一；当完成对该对象的释放时，计数器加一。当计数器为0时，进程/线程需要等待该信号量对象变长signaled状态（即计数器大于0）才能执行。

如果信号量是任意非负整数，称为一般信号量。  
如果信号量只有二进制0或1，称为二进制信号量。在Linux中，binary semaphore被称为互斥锁（Mutex）。

```
1. 初始化，给与它一个非负数的整数值。
2. 运行 P（wait()），信号量S的值将被减少。企图进入临界区块的进程，需要先运行 P（wait()）。当信号量S减为负值时，进程会被挡住，不能继续；当信号量S不为负值时，进程可以获准进入临界区块。
3. 运行 V（又称signal()），信号量S的值会被增加。结束离开临界区块的进程，将会运行 V（又称signal()）。当信号量S不为负值时，先前被挡住的其他进程，将可获准进入临界区块。
```

### 互斥信号量与二进制信号量

互斥信号量必须是由同一个任务申请，同一个任务释放。同一个任务可以递归申请。  
二进制信号量在一个任务申请成功后可以由另一个任务释放。

互斥信号量是二进制信号量的子集。

### 记录型信号量

Record Semaphore，每个信号量s除一个整数值value（计数）外，还有一个等待队列List，其中是阻塞在该信号量的各个线程的标识。当信号量被释放一个，值被加一后，系统自动从等待队列中唤醒一个等待中的线程，让其获得信号量，同时信号量再减一。
